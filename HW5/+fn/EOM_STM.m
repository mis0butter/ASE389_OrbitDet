function dX = EOM_STM(et, X)
% ------------------------------------------------------------------------
% Purpose: Generate EOM for satellite orbiting earth due to gravity (EGM 96),
% lunisolar perturbations, SRP, and drag 
% 
% Inputs 
%   t   = [7x1] time (ET epoch) vector 
%   rv  = [49x1] state vector in ECI frame (inertial) 
% 
% Outputs 
%   drv = [49x1] derivative of state vector 
% ------------------------------------------------------------------------

% force column vector 
dX = zeros(7+49, 1);   

% EOM 
dX(1:7) = fn.EOM(et, X); 

%% STM stuff 

X1 = X(1); X2 = X(2); X3 = X(3); X4 = X(4); X5 = X(5); X6 = X(6); X7 = X(7); 

Amat = zeros(7,7); 
Amat = ... 
[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 0,                                                                                                                                                                                                                                                                                                                  0; 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 0,                                                                                                                                                                                                                                                                                                                   0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 1,                                                                                                                                                                                                                                                                                                                   0;
 (6847903441654645*((1410916179400339*((15*X3)/(X1^2 + X2^2 + X3^2)^(1/2) - (35*X3^3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(3/2)) - (6988875481552467*((63*X3^4)/(X1^2 + X2^2 + X3^2)^2 - (42*X3^2)/(X1^2 + X2^2 + X3^2) + 3))/(4194304*(X1^2 + X2^2 + X3^2)^2) + (567477654410831*((5*X3^2)/(X1^2 + X2^2 + X3^2) - 1))/(8589934592*(X1^2 + X2^2 + X3^2)) - 1))/(17179869184*(X1^2 + X2^2 + X3^2)^(3/2)) - 1347671420306985/(274877906944*(abs(X2 - 3562868708294059/17179869184)^2 + abs(X3 - 1613904955520709/17179869184)^2 + abs(X1 + 2416708145969301/8589934592)^2)^(3/2)) - 132712440018/(abs(X1 - 6623097354972333/67108864)^2 + abs(X3 + 5844884687854421/134217728)^2 + abs(X2 + 6741399076023655/67108864)^2)^(3/2) - 6847903441654645/(17179869184*(X1^2 + X2^2 + X3^2)^(3/2)) + (20543710324963935*X1^2)/(17179869184*(X1^2 + X2^2 + X3^2)^(5/2)) - (6847903441654645*X1*((6988875481552467*((84*X1*X3^2)/(X1^2 + X2^2 + X3^2)^2 - (252*X1*X3^4)/(X1^2 + X2^2 + X3^2)^3))/(4194304*(X1^2 + X2^2 + X3^2)^2) - (1410916179400339*((105*X1*X3^3)/(X1^2 + X2^2 + X3^2)^(5/2) - (15*X1*X3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(3/2)) + (2837388272054155*X1*X3^2)/(4294967296*(X1^2 + X2^2 + X3^2)^3) + (4232748538201017*X1*((15*X3)/(X1^2 + X2^2 + X3^2)^(1/2) - (35*X3^3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(5/2)) - (6988875481552467*X1*((63*X3^4)/(X1^2 + X2^2 + X3^2)^2 - (42*X3^2)/(X1^2 + X2^2 + X3^2) + 3))/(1048576*(X1^2 + X2^2 + X3^2)^3) + (567477654410831*X1*((5*X3^2)/(X1^2 + X2^2 + X3^2) - 1))/(4294967296*(X1^2 + X2^2 + X3^2)^2)))/(17179869184*(X1^2 + X2^2 + X3^2)^(3/2)) - (20543710324963935*X1^2*((1410916179400339*((15*X3)/(X1^2 + X2^2 + X3^2)^(1/2) - (35*X3^3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(3/2)) - (6988875481552467*((63*X3^4)/(X1^2 + X2^2 + X3^2)^2 - (42*X3^2)/(X1^2 + X2^2 + X3^2) + 3))/(4194304*(X1^2 + X2^2 + X3^2)^2) + (567477654410831*((5*X3^2)/(X1^2 + X2^2 + X3^2) - 1))/(8589934592*(X1^2 + X2^2 + X3^2)) - 1))/(17179869184*(X1^2 + X2^2 + X3^2)^(5/2)) + (398137320054*abs(X1 - 6623097354972333/67108864)*sign(X1 - 6623097354972333/67108864)*(X1 - 6623097354972333/67108864))/(abs(X1 - 6623097354972333/67108864)^2 + abs(X3 + 5844884687854421/134217728)^2 + abs(X2 + 6741399076023655/67108864)^2)^(5/2) + (4043014260920955*abs(X1 + 2416708145969301/8589934592)*sign(X1 + 2416708145969301/8589934592)*(X1 + 2416708145969301/8589934592))/(274877906944*(abs(X2 - 3562868708294059/17179869184)^2 + abs(X3 - 1613904955520709/17179869184)^2 + abs(X1 + 2416708145969301/8589934592)^2)^(5/2)) - (12838660583545022395604932054085*X7*abs((5380631274692985*X1)/73786976294838206464 - X5)*sign((5380631274692985*X1)/73786976294838206464 - X5)*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*((5380631274692985*X2)/73786976294838206464 + X4))/(11692013098647223345629478661730264157247460343808*(abs((5380631274692985*X1)/73786976294838206464 - X5)^2 + abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2)^(1/2)) + (7158264483163783*X1*X7*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*((5380631274692985*X2)/73786976294838206464 + X4)*(abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2 + abs((5380631274692985*X1)/73786976294838206464 - X5)^2)^(1/2))/(42149540913913656128440568666652672*(X1^2 + X2^2 + X3^2)^(1/2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           (20543710324963935*X1*X2)/(17179869184*(X1^2 + X2^2 + X3^2)^(5/2)) - (12838660583545022395604932054085*X7*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*(abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2 + abs((5380631274692985*X1)/73786976294838206464 - X5)^2)^(1/2))/11692013098647223345629478661730264157247460343808 - (6847903441654645*X1*((6988875481552467*((84*X2*X3^2)/(X1^2 + X2^2 + X3^2)^2 - (252*X2*X3^4)/(X1^2 + X2^2 + X3^2)^3))/(4194304*(X1^2 + X2^2 + X3^2)^2) - (1410916179400339*((105*X2*X3^3)/(X1^2 + X2^2 + X3^2)^(5/2) - (15*X2*X3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(3/2)) + (2837388272054155*X2*X3^2)/(4294967296*(X1^2 + X2^2 + X3^2)^3) + (4232748538201017*X2*((15*X3)/(X1^2 + X2^2 + X3^2)^(1/2) - (35*X3^3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(5/2)) - (6988875481552467*X2*((63*X3^4)/(X1^2 + X2^2 + X3^2)^2 - (42*X3^2)/(X1^2 + X2^2 + X3^2) + 3))/(1048576*(X1^2 + X2^2 + X3^2)^3) + (567477654410831*X2*((5*X3^2)/(X1^2 + X2^2 + X3^2) - 1))/(4294967296*(X1^2 + X2^2 + X3^2)^2)))/(17179869184*(X1^2 + X2^2 + X3^2)^(3/2)) + (4043014260920955*abs(X2 - 3562868708294059/17179869184)*sign(X2 - 3562868708294059/17179869184)*(X1 + 2416708145969301/8589934592))/(274877906944*(abs(X2 - 3562868708294059/17179869184)^2 + abs(X3 - 1613904955520709/17179869184)^2 + abs(X1 + 2416708145969301/8589934592)^2)^(5/2)) + (398137320054*abs(X2 + 6741399076023655/67108864)*sign(X2 + 6741399076023655/67108864)*(X1 - 6623097354972333/67108864))/(abs(X1 - 6623097354972333/67108864)^2 + abs(X3 + 5844884687854421/134217728)^2 + abs(X2 + 6741399076023655/67108864)^2)^(5/2) - (20543710324963935*X1*X2*((1410916179400339*((15*X3)/(X1^2 + X2^2 + X3^2)^(1/2) - (35*X3^3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(3/2)) - (6988875481552467*((63*X3^4)/(X1^2 + X2^2 + X3^2)^2 - (42*X3^2)/(X1^2 + X2^2 + X3^2) + 3))/(4194304*(X1^2 + X2^2 + X3^2)^2) + (567477654410831*((5*X3^2)/(X1^2 + X2^2 + X3^2) - 1))/(8589934592*(X1^2 + X2^2 + X3^2)) - 1))/(17179869184*(X1^2 + X2^2 + X3^2)^(5/2)) - (12838660583545022395604932054085*X7*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*abs((5380631274692985*X2)/73786976294838206464 + X4)*sign((5380631274692985*X2)/73786976294838206464 + X4)*((5380631274692985*X2)/73786976294838206464 + X4))/(11692013098647223345629478661730264157247460343808*(abs((5380631274692985*X1)/73786976294838206464 - X5)^2 + abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2)^(1/2)) + (7158264483163783*X2*X7*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*((5380631274692985*X2)/73786976294838206464 + X4)*(abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2 + abs((5380631274692985*X1)/73786976294838206464 - X5)^2)^(1/2))/(42149540913913656128440568666652672*(X1^2 + X2^2 + X3^2)^(1/2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             (6847903441654645*X1*((6988875481552467*((84*X3)/(X1^2 + X2^2 + X3^2) - (336*X3^3)/(X1^2 + X2^2 + X3^2)^2 + (252*X3^5)/(X1^2 + X2^2 + X3^2)^3))/(4194304*(X1^2 + X2^2 + X3^2)^2) + (567477654410831*((10*X3)/(X1^2 + X2^2 + X3^2) - (10*X3^3)/(X1^2 + X2^2 + X3^2)^2))/(8589934592*(X1^2 + X2^2 + X3^2)) + (1410916179400339*(15/(X1^2 + X2^2 + X3^2)^(1/2) - (120*X3^2)/(X1^2 + X2^2 + X3^2)^(3/2) + (105*X3^4)/(X1^2 + X2^2 + X3^2)^(5/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(3/2)) - (4232748538201017*X3*((15*X3)/(X1^2 + X2^2 + X3^2)^(1/2) - (35*X3^3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(5/2)) + (6988875481552467*X3*((63*X3^4)/(X1^2 + X2^2 + X3^2)^2 - (42*X3^2)/(X1^2 + X2^2 + X3^2) + 3))/(1048576*(X1^2 + X2^2 + X3^2)^3) - (567477654410831*X3*((5*X3^2)/(X1^2 + X2^2 + X3^2) - 1))/(4294967296*(X1^2 + X2^2 + X3^2)^2)))/(17179869184*(X1^2 + X2^2 + X3^2)^(3/2)) + (20543710324963935*X1*X3)/(17179869184*(X1^2 + X2^2 + X3^2)^(5/2)) + (4043014260920955*abs(X3 - 1613904955520709/17179869184)*sign(X3 - 1613904955520709/17179869184)*(X1 + 2416708145969301/8589934592))/(274877906944*(abs(X2 - 3562868708294059/17179869184)^2 + abs(X3 - 1613904955520709/17179869184)^2 + abs(X1 + 2416708145969301/8589934592)^2)^(5/2)) + (398137320054*abs(X3 + 5844884687854421/134217728)*sign(X3 + 5844884687854421/134217728)*(X1 - 6623097354972333/67108864))/(abs(X1 - 6623097354972333/67108864)^2 + abs(X3 + 5844884687854421/134217728)^2 + abs(X2 + 6741399076023655/67108864)^2)^(5/2) - (20543710324963935*X1*X3*((1410916179400339*((15*X3)/(X1^2 + X2^2 + X3^2)^(1/2) - (35*X3^3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(3/2)) - (6988875481552467*((63*X3^4)/(X1^2 + X2^2 + X3^2)^2 - (42*X3^2)/(X1^2 + X2^2 + X3^2) + 3))/(4194304*(X1^2 + X2^2 + X3^2)^2) + (567477654410831*((5*X3^2)/(X1^2 + X2^2 + X3^2) - 1))/(8589934592*(X1^2 + X2^2 + X3^2)) - 1))/(17179869184*(X1^2 + X2^2 + X3^2)^(5/2)) + (7158264483163783*X3*X7*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*((5380631274692985*X2)/73786976294838206464 + X4)*(abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2 + abs((5380631274692985*X1)/73786976294838206464 - X5)^2)^(1/2))/(42149540913913656128440568666652672*(X1^2 + X2^2 + X3^2)^(1/2)), - (7158264483163783*X7*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*(abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2 + abs((5380631274692985*X1)/73786976294838206464 - X5)^2)^(1/2))/475368975085586025561263702016 - (7158264483163783*X7*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*abs((5380631274692985*X2)/73786976294838206464 + X4)*sign((5380631274692985*X2)/73786976294838206464 + X4)*((5380631274692985*X2)/73786976294838206464 + X4))/(475368975085586025561263702016*(abs((5380631274692985*X1)/73786976294838206464 - X5)^2 + abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2)^(1/2)),                                                                                                                                                                                                                                                                         (7158264483163783*X7*abs((5380631274692985*X1)/73786976294838206464 - X5)*sign((5380631274692985*X1)/73786976294838206464 - X5)*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*((5380631274692985*X2)/73786976294838206464 + X4))/(475368975085586025561263702016*(abs((5380631274692985*X1)/73786976294838206464 - X5)^2 + abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2)^(1/2)),                                                                                                                                                                                                                         -(7158264483163783*X7*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*abs(X6)*sign(X6)*((5380631274692985*X2)/73786976294838206464 + X4))/(475368975085586025561263702016*(abs((5380631274692985*X1)/73786976294838206464 - X5)^2 + abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2)^(1/2)), -(7158264483163783*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*((5380631274692985*X2)/73786976294838206464 + X4)*(abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2 + abs((5380631274692985*X1)/73786976294838206464 - X5)^2)^(1/2))/475368975085586025561263702016;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         (12838660583545022395604932054085*X7*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*(abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2 + abs((5380631274692985*X1)/73786976294838206464 - X5)^2)^(1/2))/11692013098647223345629478661730264157247460343808 - (6847903441654645*X2*((6988875481552467*((84*X1*X3^2)/(X1^2 + X2^2 + X3^2)^2 - (252*X1*X3^4)/(X1^2 + X2^2 + X3^2)^3))/(4194304*(X1^2 + X2^2 + X3^2)^2) - (1410916179400339*((105*X1*X3^3)/(X1^2 + X2^2 + X3^2)^(5/2) - (15*X1*X3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(3/2)) + (2837388272054155*X1*X3^2)/(4294967296*(X1^2 + X2^2 + X3^2)^3) + (4232748538201017*X1*((15*X3)/(X1^2 + X2^2 + X3^2)^(1/2) - (35*X3^3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(5/2)) - (6988875481552467*X1*((63*X3^4)/(X1^2 + X2^2 + X3^2)^2 - (42*X3^2)/(X1^2 + X2^2 + X3^2) + 3))/(1048576*(X1^2 + X2^2 + X3^2)^3) + (567477654410831*X1*((5*X3^2)/(X1^2 + X2^2 + X3^2) - 1))/(4294967296*(X1^2 + X2^2 + X3^2)^2)))/(17179869184*(X1^2 + X2^2 + X3^2)^(3/2)) + (20543710324963935*X1*X2)/(17179869184*(X1^2 + X2^2 + X3^2)^(5/2)) + (4043014260920955*abs(X1 + 2416708145969301/8589934592)*sign(X1 + 2416708145969301/8589934592)*(X2 - 3562868708294059/17179869184))/(274877906944*(abs(X2 - 3562868708294059/17179869184)^2 + abs(X3 - 1613904955520709/17179869184)^2 + abs(X1 + 2416708145969301/8589934592)^2)^(5/2)) + (398137320054*abs(X1 - 6623097354972333/67108864)*sign(X1 - 6623097354972333/67108864)*(X2 + 6741399076023655/67108864))/(abs(X1 - 6623097354972333/67108864)^2 + abs(X3 + 5844884687854421/134217728)^2 + abs(X2 + 6741399076023655/67108864)^2)^(5/2) - (20543710324963935*X1*X2*((1410916179400339*((15*X3)/(X1^2 + X2^2 + X3^2)^(1/2) - (35*X3^3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(3/2)) - (6988875481552467*((63*X3^4)/(X1^2 + X2^2 + X3^2)^2 - (42*X3^2)/(X1^2 + X2^2 + X3^2) + 3))/(4194304*(X1^2 + X2^2 + X3^2)^2) + (567477654410831*((5*X3^2)/(X1^2 + X2^2 + X3^2) - 1))/(8589934592*(X1^2 + X2^2 + X3^2)) - 1))/(17179869184*(X1^2 + X2^2 + X3^2)^(5/2)) + (12838660583545022395604932054085*X7*abs((5380631274692985*X1)/73786976294838206464 - X5)*sign((5380631274692985*X1)/73786976294838206464 - X5)*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*((5380631274692985*X1)/73786976294838206464 - X5))/(11692013098647223345629478661730264157247460343808*(abs((5380631274692985*X1)/73786976294838206464 - X5)^2 + abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2)^(1/2)) - (7158264483163783*X1*X7*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*((5380631274692985*X1)/73786976294838206464 - X5)*(abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2 + abs((5380631274692985*X1)/73786976294838206464 - X5)^2)^(1/2))/(42149540913913656128440568666652672*(X1^2 + X2^2 + X3^2)^(1/2)), (6847903441654645*((1410916179400339*((15*X3)/(X1^2 + X2^2 + X3^2)^(1/2) - (35*X3^3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(3/2)) - (6988875481552467*((63*X3^4)/(X1^2 + X2^2 + X3^2)^2 - (42*X3^2)/(X1^2 + X2^2 + X3^2) + 3))/(4194304*(X1^2 + X2^2 + X3^2)^2) + (567477654410831*((5*X3^2)/(X1^2 + X2^2 + X3^2) - 1))/(8589934592*(X1^2 + X2^2 + X3^2)) - 1))/(17179869184*(X1^2 + X2^2 + X3^2)^(3/2)) - 1347671420306985/(274877906944*(abs(X2 - 3562868708294059/17179869184)^2 + abs(X3 - 1613904955520709/17179869184)^2 + abs(X1 + 2416708145969301/8589934592)^2)^(3/2)) - 132712440018/(abs(X1 - 6623097354972333/67108864)^2 + abs(X3 + 5844884687854421/134217728)^2 + abs(X2 + 6741399076023655/67108864)^2)^(3/2) - 6847903441654645/(17179869184*(X1^2 + X2^2 + X3^2)^(3/2)) + (20543710324963935*X2^2)/(17179869184*(X1^2 + X2^2 + X3^2)^(5/2)) - (6847903441654645*X2*((6988875481552467*((84*X2*X3^2)/(X1^2 + X2^2 + X3^2)^2 - (252*X2*X3^4)/(X1^2 + X2^2 + X3^2)^3))/(4194304*(X1^2 + X2^2 + X3^2)^2) - (1410916179400339*((105*X2*X3^3)/(X1^2 + X2^2 + X3^2)^(5/2) - (15*X2*X3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(3/2)) + (2837388272054155*X2*X3^2)/(4294967296*(X1^2 + X2^2 + X3^2)^3) + (4232748538201017*X2*((15*X3)/(X1^2 + X2^2 + X3^2)^(1/2) - (35*X3^3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(5/2)) - (6988875481552467*X2*((63*X3^4)/(X1^2 + X2^2 + X3^2)^2 - (42*X3^2)/(X1^2 + X2^2 + X3^2) + 3))/(1048576*(X1^2 + X2^2 + X3^2)^3) + (567477654410831*X2*((5*X3^2)/(X1^2 + X2^2 + X3^2) - 1))/(4294967296*(X1^2 + X2^2 + X3^2)^2)))/(17179869184*(X1^2 + X2^2 + X3^2)^(3/2)) - (20543710324963935*X2^2*((1410916179400339*((15*X3)/(X1^2 + X2^2 + X3^2)^(1/2) - (35*X3^3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(3/2)) - (6988875481552467*((63*X3^4)/(X1^2 + X2^2 + X3^2)^2 - (42*X3^2)/(X1^2 + X2^2 + X3^2) + 3))/(4194304*(X1^2 + X2^2 + X3^2)^2) + (567477654410831*((5*X3^2)/(X1^2 + X2^2 + X3^2) - 1))/(8589934592*(X1^2 + X2^2 + X3^2)) - 1))/(17179869184*(X1^2 + X2^2 + X3^2)^(5/2)) + (398137320054*abs(X2 + 6741399076023655/67108864)*sign(X2 + 6741399076023655/67108864)*(X2 + 6741399076023655/67108864))/(abs(X1 - 6623097354972333/67108864)^2 + abs(X3 + 5844884687854421/134217728)^2 + abs(X2 + 6741399076023655/67108864)^2)^(5/2) + (4043014260920955*abs(X2 - 3562868708294059/17179869184)*sign(X2 - 3562868708294059/17179869184)*(X2 - 3562868708294059/17179869184))/(274877906944*(abs(X2 - 3562868708294059/17179869184)^2 + abs(X3 - 1613904955520709/17179869184)^2 + abs(X1 + 2416708145969301/8589934592)^2)^(5/2)) - (7158264483163783*X2*X7*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*((5380631274692985*X1)/73786976294838206464 - X5)*(abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2 + abs((5380631274692985*X1)/73786976294838206464 - X5)^2)^(1/2))/(42149540913913656128440568666652672*(X1^2 + X2^2 + X3^2)^(1/2)) + (12838660583545022395604932054085*X7*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*abs((5380631274692985*X2)/73786976294838206464 + X4)*sign((5380631274692985*X2)/73786976294838206464 + X4)*((5380631274692985*X1)/73786976294838206464 - X5))/(11692013098647223345629478661730264157247460343808*(abs((5380631274692985*X1)/73786976294838206464 - X5)^2 + abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2)^(1/2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            (6847903441654645*X2*((6988875481552467*((84*X3)/(X1^2 + X2^2 + X3^2) - (336*X3^3)/(X1^2 + X2^2 + X3^2)^2 + (252*X3^5)/(X1^2 + X2^2 + X3^2)^3))/(4194304*(X1^2 + X2^2 + X3^2)^2) + (567477654410831*((10*X3)/(X1^2 + X2^2 + X3^2) - (10*X3^3)/(X1^2 + X2^2 + X3^2)^2))/(8589934592*(X1^2 + X2^2 + X3^2)) + (1410916179400339*(15/(X1^2 + X2^2 + X3^2)^(1/2) - (120*X3^2)/(X1^2 + X2^2 + X3^2)^(3/2) + (105*X3^4)/(X1^2 + X2^2 + X3^2)^(5/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(3/2)) - (4232748538201017*X3*((15*X3)/(X1^2 + X2^2 + X3^2)^(1/2) - (35*X3^3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(5/2)) + (6988875481552467*X3*((63*X3^4)/(X1^2 + X2^2 + X3^2)^2 - (42*X3^2)/(X1^2 + X2^2 + X3^2) + 3))/(1048576*(X1^2 + X2^2 + X3^2)^3) - (567477654410831*X3*((5*X3^2)/(X1^2 + X2^2 + X3^2) - 1))/(4294967296*(X1^2 + X2^2 + X3^2)^2)))/(17179869184*(X1^2 + X2^2 + X3^2)^(3/2)) + (20543710324963935*X2*X3)/(17179869184*(X1^2 + X2^2 + X3^2)^(5/2)) + (398137320054*abs(X3 + 5844884687854421/134217728)*sign(X3 + 5844884687854421/134217728)*(X2 + 6741399076023655/67108864))/(abs(X1 - 6623097354972333/67108864)^2 + abs(X3 + 5844884687854421/134217728)^2 + abs(X2 + 6741399076023655/67108864)^2)^(5/2) + (4043014260920955*abs(X3 - 1613904955520709/17179869184)*sign(X3 - 1613904955520709/17179869184)*(X2 - 3562868708294059/17179869184))/(274877906944*(abs(X2 - 3562868708294059/17179869184)^2 + abs(X3 - 1613904955520709/17179869184)^2 + abs(X1 + 2416708145969301/8589934592)^2)^(5/2)) - (20543710324963935*X2*X3*((1410916179400339*((15*X3)/(X1^2 + X2^2 + X3^2)^(1/2) - (35*X3^3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(3/2)) - (6988875481552467*((63*X3^4)/(X1^2 + X2^2 + X3^2)^2 - (42*X3^2)/(X1^2 + X2^2 + X3^2) + 3))/(4194304*(X1^2 + X2^2 + X3^2)^2) + (567477654410831*((5*X3^2)/(X1^2 + X2^2 + X3^2) - 1))/(8589934592*(X1^2 + X2^2 + X3^2)) - 1))/(17179869184*(X1^2 + X2^2 + X3^2)^(5/2)) - (7158264483163783*X3*X7*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*((5380631274692985*X1)/73786976294838206464 - X5)*(abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2 + abs((5380631274692985*X1)/73786976294838206464 - X5)^2)^(1/2))/(42149540913913656128440568666652672*(X1^2 + X2^2 + X3^2)^(1/2)),                                                                                                                                                                                                                                                                         (7158264483163783*X7*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*abs((5380631274692985*X2)/73786976294838206464 + X4)*sign((5380631274692985*X2)/73786976294838206464 + X4)*((5380631274692985*X1)/73786976294838206464 - X5))/(475368975085586025561263702016*(abs((5380631274692985*X1)/73786976294838206464 - X5)^2 + abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2)^(1/2)), - (7158264483163783*X7*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*(abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2 + abs((5380631274692985*X1)/73786976294838206464 - X5)^2)^(1/2))/475368975085586025561263702016 - (7158264483163783*X7*abs((5380631274692985*X1)/73786976294838206464 - X5)*sign((5380631274692985*X1)/73786976294838206464 - X5)*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*((5380631274692985*X1)/73786976294838206464 - X5))/(475368975085586025561263702016*(abs((5380631274692985*X1)/73786976294838206464 - X5)^2 + abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2)^(1/2)),                                                                                                                                                                                                                          (7158264483163783*X7*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*abs(X6)*sign(X6)*((5380631274692985*X1)/73786976294838206464 - X5))/(475368975085586025561263702016*(abs((5380631274692985*X1)/73786976294838206464 - X5)^2 + abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2)^(1/2)),  (7158264483163783*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*((5380631274692985*X1)/73786976294838206464 - X5)*(abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2 + abs((5380631274692985*X1)/73786976294838206464 - X5)^2)^(1/2))/475368975085586025561263702016;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            (20543710324963935*X1*X3)/(17179869184*(X1^2 + X2^2 + X3^2)^(5/2)) - (6847903441654645*X3*((1410916179400339*((3*X1)/(X3*(X1^2 + X2^2 + X3^2)^(1/2)) - (105*X1*X3^3)/(X1^2 + X2^2 + X3^2)^(5/2) + (30*X1*X3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(3/2)) + (6988875481552467*((140*X1*X3^2)/(X1^2 + X2^2 + X3^2)^2 - (252*X1*X3^4)/(X1^2 + X2^2 + X3^2)^3))/(4194304*(X1^2 + X2^2 + X3^2)^2) + (2837388272054155*X1*X3^2)/(4294967296*(X1^2 + X2^2 + X3^2)^3) - (4232748538201017*X1*((3*(X1^2 + X2^2 + X3^2)^(1/2))/X3 - (30*X3)/(X1^2 + X2^2 + X3^2)^(1/2) + (35*X3^3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(5/2)) - (6988875481552467*X1*((63*X3^4)/(X1^2 + X2^2 + X3^2)^2 - (70*X3^2)/(X1^2 + X2^2 + X3^2) + 15))/(1048576*(X1^2 + X2^2 + X3^2)^3) + (567477654410831*X1*((5*X3^2)/(X1^2 + X2^2 + X3^2) - 3))/(4294967296*(X1^2 + X2^2 + X3^2)^2)))/(17179869184*(X1^2 + X2^2 + X3^2)^(3/2)) + (398137320054*abs(X1 - 6623097354972333/67108864)*sign(X1 - 6623097354972333/67108864)*(X3 + 5844884687854421/134217728))/(abs(X1 - 6623097354972333/67108864)^2 + abs(X3 + 5844884687854421/134217728)^2 + abs(X2 + 6741399076023655/67108864)^2)^(5/2) + (4043014260920955*abs(X1 + 2416708145969301/8589934592)*sign(X1 + 2416708145969301/8589934592)*(X3 - 1613904955520709/17179869184))/(274877906944*(abs(X2 - 3562868708294059/17179869184)^2 + abs(X3 - 1613904955520709/17179869184)^2 + abs(X1 + 2416708145969301/8589934592)^2)^(5/2)) + (20543710324963935*X1*X3*((1410916179400339*((3*(X1^2 + X2^2 + X3^2)^(1/2))/X3 - (30*X3)/(X1^2 + X2^2 + X3^2)^(1/2) + (35*X3^3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(3/2)) + (6988875481552467*((63*X3^4)/(X1^2 + X2^2 + X3^2)^2 - (70*X3^2)/(X1^2 + X2^2 + X3^2) + 15))/(4194304*(X1^2 + X2^2 + X3^2)^2) - (567477654410831*((5*X3^2)/(X1^2 + X2^2 + X3^2) - 3))/(8589934592*(X1^2 + X2^2 + X3^2)) + 1))/(17179869184*(X1^2 + X2^2 + X3^2)^(5/2)) + (7158264483163783*X1*X6*X7*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*(abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2 + abs((5380631274692985*X1)/73786976294838206464 - X5)^2)^(1/2))/(42149540913913656128440568666652672*(X1^2 + X2^2 + X3^2)^(1/2)) - (12838660583545022395604932054085*X6*X7*abs((5380631274692985*X1)/73786976294838206464 - X5)*sign((5380631274692985*X1)/73786976294838206464 - X5)*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667))/(11692013098647223345629478661730264157247460343808*(abs((5380631274692985*X1)/73786976294838206464 - X5)^2 + abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2)^(1/2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             (20543710324963935*X2*X3)/(17179869184*(X1^2 + X2^2 + X3^2)^(5/2)) - (6847903441654645*X3*((1410916179400339*((3*X2)/(X3*(X1^2 + X2^2 + X3^2)^(1/2)) - (105*X2*X3^3)/(X1^2 + X2^2 + X3^2)^(5/2) + (30*X2*X3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(3/2)) + (6988875481552467*((140*X2*X3^2)/(X1^2 + X2^2 + X3^2)^2 - (252*X2*X3^4)/(X1^2 + X2^2 + X3^2)^3))/(4194304*(X1^2 + X2^2 + X3^2)^2) + (2837388272054155*X2*X3^2)/(4294967296*(X1^2 + X2^2 + X3^2)^3) - (4232748538201017*X2*((3*(X1^2 + X2^2 + X3^2)^(1/2))/X3 - (30*X3)/(X1^2 + X2^2 + X3^2)^(1/2) + (35*X3^3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(5/2)) - (6988875481552467*X2*((63*X3^4)/(X1^2 + X2^2 + X3^2)^2 - (70*X3^2)/(X1^2 + X2^2 + X3^2) + 15))/(1048576*(X1^2 + X2^2 + X3^2)^3) + (567477654410831*X2*((5*X3^2)/(X1^2 + X2^2 + X3^2) - 3))/(4294967296*(X1^2 + X2^2 + X3^2)^2)))/(17179869184*(X1^2 + X2^2 + X3^2)^(3/2)) + (398137320054*abs(X2 + 6741399076023655/67108864)*sign(X2 + 6741399076023655/67108864)*(X3 + 5844884687854421/134217728))/(abs(X1 - 6623097354972333/67108864)^2 + abs(X3 + 5844884687854421/134217728)^2 + abs(X2 + 6741399076023655/67108864)^2)^(5/2) + (4043014260920955*abs(X2 - 3562868708294059/17179869184)*sign(X2 - 3562868708294059/17179869184)*(X3 - 1613904955520709/17179869184))/(274877906944*(abs(X2 - 3562868708294059/17179869184)^2 + abs(X3 - 1613904955520709/17179869184)^2 + abs(X1 + 2416708145969301/8589934592)^2)^(5/2)) + (20543710324963935*X2*X3*((1410916179400339*((3*(X1^2 + X2^2 + X3^2)^(1/2))/X3 - (30*X3)/(X1^2 + X2^2 + X3^2)^(1/2) + (35*X3^3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(3/2)) + (6988875481552467*((63*X3^4)/(X1^2 + X2^2 + X3^2)^2 - (70*X3^2)/(X1^2 + X2^2 + X3^2) + 15))/(4194304*(X1^2 + X2^2 + X3^2)^2) - (567477654410831*((5*X3^2)/(X1^2 + X2^2 + X3^2) - 3))/(8589934592*(X1^2 + X2^2 + X3^2)) + 1))/(17179869184*(X1^2 + X2^2 + X3^2)^(5/2)) + (7158264483163783*X2*X6*X7*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*(abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2 + abs((5380631274692985*X1)/73786976294838206464 - X5)^2)^(1/2))/(42149540913913656128440568666652672*(X1^2 + X2^2 + X3^2)^(1/2)) - (12838660583545022395604932054085*X6*X7*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*abs((5380631274692985*X2)/73786976294838206464 + X4)*sign((5380631274692985*X2)/73786976294838206464 + X4))/(11692013098647223345629478661730264157247460343808*(abs((5380631274692985*X1)/73786976294838206464 - X5)^2 + abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2)^(1/2)), (20543710324963935*X3^2)/(17179869184*(X1^2 + X2^2 + X3^2)^(5/2)) - 1347671420306985/(274877906944*(abs(X2 - 3562868708294059/17179869184)^2 + abs(X3 - 1613904955520709/17179869184)^2 + abs(X1 + 2416708145969301/8589934592)^2)^(3/2)) - 132712440018/(abs(X1 - 6623097354972333/67108864)^2 + abs(X3 + 5844884687854421/134217728)^2 + abs(X2 + 6741399076023655/67108864)^2)^(3/2) - 6847903441654645/(17179869184*(X1^2 + X2^2 + X3^2)^(3/2)) - (6847903441654645*((1410916179400339*((3*(X1^2 + X2^2 + X3^2)^(1/2))/X3 - (30*X3)/(X1^2 + X2^2 + X3^2)^(1/2) + (35*X3^3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(3/2)) + (6988875481552467*((63*X3^4)/(X1^2 + X2^2 + X3^2)^2 - (70*X3^2)/(X1^2 + X2^2 + X3^2) + 15))/(4194304*(X1^2 + X2^2 + X3^2)^2) - (567477654410831*((5*X3^2)/(X1^2 + X2^2 + X3^2) - 3))/(8589934592*(X1^2 + X2^2 + X3^2)) + 1))/(17179869184*(X1^2 + X2^2 + X3^2)^(3/2)) + (6847903441654645*X3*((6988875481552467*((140*X3)/(X1^2 + X2^2 + X3^2) - (392*X3^3)/(X1^2 + X2^2 + X3^2)^2 + (252*X3^5)/(X1^2 + X2^2 + X3^2)^3))/(4194304*(X1^2 + X2^2 + X3^2)^2) + (567477654410831*((10*X3)/(X1^2 + X2^2 + X3^2) - (10*X3^3)/(X1^2 + X2^2 + X3^2)^2))/(8589934592*(X1^2 + X2^2 + X3^2)) + (1410916179400339*(27/(X1^2 + X2^2 + X3^2)^(1/2) + (3*(X1^2 + X2^2 + X3^2)^(1/2))/X3^2 - (135*X3^2)/(X1^2 + X2^2 + X3^2)^(3/2) + (105*X3^4)/(X1^2 + X2^2 + X3^2)^(5/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(3/2)) + (4232748538201017*X3*((3*(X1^2 + X2^2 + X3^2)^(1/2))/X3 - (30*X3)/(X1^2 + X2^2 + X3^2)^(1/2) + (35*X3^3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(5/2)) + (6988875481552467*X3*((63*X3^4)/(X1^2 + X2^2 + X3^2)^2 - (70*X3^2)/(X1^2 + X2^2 + X3^2) + 15))/(1048576*(X1^2 + X2^2 + X3^2)^3) - (567477654410831*X3*((5*X3^2)/(X1^2 + X2^2 + X3^2) - 3))/(4294967296*(X1^2 + X2^2 + X3^2)^2)))/(17179869184*(X1^2 + X2^2 + X3^2)^(3/2)) + (20543710324963935*X3^2*((1410916179400339*((3*(X1^2 + X2^2 + X3^2)^(1/2))/X3 - (30*X3)/(X1^2 + X2^2 + X3^2)^(1/2) + (35*X3^3)/(X1^2 + X2^2 + X3^2)^(3/2)))/(4294967296*(X1^2 + X2^2 + X3^2)^(3/2)) + (6988875481552467*((63*X3^4)/(X1^2 + X2^2 + X3^2)^2 - (70*X3^2)/(X1^2 + X2^2 + X3^2) + 15))/(4194304*(X1^2 + X2^2 + X3^2)^2) - (567477654410831*((5*X3^2)/(X1^2 + X2^2 + X3^2) - 3))/(8589934592*(X1^2 + X2^2 + X3^2)) + 1))/(17179869184*(X1^2 + X2^2 + X3^2)^(5/2)) + (398137320054*abs(X3 + 5844884687854421/134217728)*sign(X3 + 5844884687854421/134217728)*(X3 + 5844884687854421/134217728))/(abs(X1 - 6623097354972333/67108864)^2 + abs(X3 + 5844884687854421/134217728)^2 + abs(X2 + 6741399076023655/67108864)^2)^(5/2) + (4043014260920955*abs(X3 - 1613904955520709/17179869184)*sign(X3 - 1613904955520709/17179869184)*(X3 - 1613904955520709/17179869184))/(274877906944*(abs(X2 - 3562868708294059/17179869184)^2 + abs(X3 - 1613904955520709/17179869184)^2 + abs(X1 + 2416708145969301/8589934592)^2)^(5/2)) + (7158264483163783*X3*X6*X7*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*(abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2 + abs((5380631274692985*X1)/73786976294838206464 - X5)^2)^(1/2))/(42149540913913656128440568666652672*(X1^2 + X2^2 + X3^2)^(1/2)),                                                                                                                                                                                                                                                                                                                       -(7158264483163783*X6*X7*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*abs((5380631274692985*X2)/73786976294838206464 + X4)*sign((5380631274692985*X2)/73786976294838206464 + X4))/(475368975085586025561263702016*(abs((5380631274692985*X1)/73786976294838206464 - X5)^2 + abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2)^(1/2)),                                                                                                                                                                                                                                                                                                                        (7158264483163783*X6*X7*abs((5380631274692985*X1)/73786976294838206464 - X5)*sign((5380631274692985*X1)/73786976294838206464 - X5)*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667))/(475368975085586025561263702016*(abs((5380631274692985*X1)/73786976294838206464 - X5)^2 + abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2)^(1/2)), - (7158264483163783*X7*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*(abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2 + abs((5380631274692985*X1)/73786976294838206464 - X5)^2)^(1/2))/475368975085586025561263702016 - (7158264483163783*X6*X7*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*abs(X6)*sign(X6))/(475368975085586025561263702016*(abs((5380631274692985*X1)/73786976294838206464 - X5)^2 + abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2)^(1/2)),                                                -(7158264483163783*X6*exp(3891246582416697/48745198750007296 - (X1^2 + X2^2 + X3^2)^(1/2)/88667)*(abs((5380631274692985*X2)/73786976294838206464 + X4)^2 + abs(X6)^2 + abs((5380631274692985*X1)/73786976294838206464 - X5)^2)^(1/2))/475368975085586025561263702016;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 0,                                                                                                                                                                                                                                                                                                                   0]; 
 

STM = X(8:7+49); 
STM = reshape(STM, [7 7]); 
dSTM = Amat*STM; 
dSTM = reshape(dSTM, [49,1]); 

dX(8:7+49) = dSTM; 

end 



%% functions 

function rv = spice_state(epoch, target, frame, abcorr, observer) 

    rv = zeros(length(epoch), 6); 
    
    for i = 1:length(epoch) 

        %  Look-up the state for the defined parameters.
        starg   = mice_spkezr( target, epoch(i), frame, abcorr, observer);
        rv(i,:) = starg.state(1:6); 
        
    end 

end 


